🧘‍♂️ 复盘

#### 

为什么要复盘

- “一个能做出高质量复盘的组织，差不多是可以做好所有事的。” -- 美团联合创始人 王慧文
    
- “从本质上看，人类只能通过试错法进行学习” -- 美国的系统科学家 彼得 · 圣吉
    

![](https://juzihudong.feishu.cn/space/api/box/stream/download/asynccode/?code=NDVhYzQ2ZjRlNzBkNDJjNGUzNWNlNDdmYjc5MTIzNDhfczJpM1V2bzd6R2I2ZzlZZlFwOENoRW9lV1UyNVJ0cjZfVG9rZW46Ym94Y25rRlZlWDRYbkZDRlgxUFRvSzd4ZFNnXzE3Njc1MDYzNTI6MTc2NzUwOTk1Ml9WNA)

以航空业为案例，飞行员的行为准则里有很多看似奇葩的规定，其实都是由事故作为依据而制定出来的。比如国际民航组织就规定飞行员在工作中必须说英语，这是为了防止像日语和韩语中的存在敬语可能影响机长的判断；再比如机长和副机长必须吃不同的人准备的不同种类食物，并且吃饭间隔时间必须要30分钟以上，这是为了防止可能的食物中毒；这些事件都在之前的航空史上真实发生过，可以说都是血和泪的教训。

很多潜在的风险和问题由于过于隐蔽和低概率，如果靠凭空想象出来是非常困难的，航空业能想到这么细致的原因，不是因为他们想象力丰富，而是能够**及时把过去曾经发生过的错误，最大程度转化为未来可以小心和避免的方法**，这类行为其实就是我们今天要重点讨论的故障复盘。

- **故障是常态，无法完全避免，我们唯一要学会的是如何成长**
    

系统正常，只是该系统无数异常情况下的一种特例。

所以面对故障的正确姿势应该是，事前尽可能控制，但是由于事前无法完全预测和消除，所以系统设计必须考虑“为失效而设计（Design for Failure）”，并在此基础上切实推行有效的复盘机制，才能最终提升复杂系统的鲁棒性。

研究失败的逻辑非常重要，复制成功者的所作所为，不一定会让你更成功，而避免失败者的做事套路，将一定会增加你的成功概率。

项目失败并不可怕，我们每一次经历都是一次试错，学会从试错的经历中复盘，就是我们螺旋式成长的必经之路。

**不“浪费（忽视）”任何一个失误**

- **故障是表象，背后技术管理上的问题才是根因**

_**海恩法则告诉我们，每一起严重事故的背后，必然有29次轻微事故和300起未遂先兆以及1000起事故隐患。**_

技术管理上的问题在积累到一定量之后，会通过故障的形式爆发出来，而故障本身只是表面现象。

任何一个故障的具体原因都可以归结到某些具体的技术点上，但是技术管理不应该只是“头痛医头脚痛医脚”的角色，而应该是站在更高的全局视角看问题。比如你应该这样来思考问题：

- _故障无法快速定位是不是系统的可观测性设计出了问题_
    
- _故障发现不及时是不是监控覆盖度不够_
    
- _容量故障是不是限流、降级、熔断等保障手段缺失_
    
- _局部小问题的牵一发而动全身是不是故障隔离没有考虑_
    
- _故障预案在遇到问题时失效，是不是故障预案停留在纸上谈兵，没有实际演练_
    
- _某些流程经常出错，是不是人工操作步骤太多，或者流程本身需要改善_
    
- _生产环境的人因故障是不是缺乏对生产环境的敬畏之心_
    

- **可以包容失败，但是不允许犯错**

对于一些本身就极具挑战性的技术或解决方案，由于团队，甚至是业界可能都没有可供直接借鉴的经验，结果在落地的过程中踩到了一些坑而没能成功，这种失败是可以接受的。

而犯错往往是指那些已经**明确知道不能做的事情依然在做，同样的或者类似的错误不断重复发生**，这就无法被接受，必须通过处罚等手段来提升责任心和敬畏意识。例如，在工作中需要遵守所谓的“成人法则”，员工不是“巨婴”，犯过的错误应该通过各种手段防止再犯，比如遵守规范，流程，增加检查清单等研发纪律。总而言之，_**我们最终的目的是鼓励做事，而不是处罚失败。**_

团队的复盘能力有多强，决定了团队的进步空间有多大

避免低质量的重复，每一次比上一次做得更好一点

#### 

如何复盘

1. 首先，把技术背景和时间线都拉出来，把事实分析清楚。
    

- 事实部分写清楚的标准：任何一个没有背景信息的人看到这个文档，都能知道发生了什么。这个不代表要事无巨细，相反要拉时间线，要足够简单。没有背景信息的人更需要大纲，更没有兴趣去读论文。
    
- 为什么要让没有背景信息的人知道发生了什么：因为每次复盘都一定发生了一个重大失误，我们希望积累下一次如何做的更好的方案，一定是和这次的事故相关联的，如果不能一句话说清楚这次的事故，那下一次做的更好的解决方案也是不落地的，举例：国际民航组织就规定飞行员在工作中必须说英语，这是为了防止像日语和韩语中的存在敬语可能影响机长的判断。
    
- 识别和分析故障触发条件和关键环节，层层下钻故障根因，技术领域所有的东西都是确定的，不存在模棱两可的描述，针对人也不存在模棱两可的描述，要精准说明。
    
- 事实
    
    - “XXX 客户由于 XX 原因，在这个月没有成交，预计下个月成交”
        
    - “XX 客户宕机原因： #123，#124 （123,124 是 issue 链接或者 pingcode 链接，标准按照 issue 标准走，并给出具体的责任人，和是否解决的明确说明，每个链接只说明一个事情）”
        

2. 然后，把事实、分析、经验联动起来，归纳推演出后续的跟进措施，总结经验教训 -- _**多问为什么**_
    

举个丰田的例子，工厂车间地上漏了一大片油，常规的处理方式就是先清理地上的油，然后检查机器哪个部位漏油，换掉有问题的零件就好了。

但是按照丰田的思路，会引导工程师继续追问：为什么地上会有油？因为机器漏油了。为什么机器会漏油？因为一个零件老化，磨损严重，导致漏油。为什么零件会磨损严重？因为质量不好。为什么要用质量不好的零件？因为采购成本低。为什么要控制采购成本？因为节省短期成本，是采购部门的绩效考核标准。你看，问了一系列的“为什么”，漏油的根本原因才找到了。所以对漏油事件的根本解决方案，其实是改变对采购部门的绩效考核标准，除了关注成本还要加强质量因素的比重，这样才能防止以后发生类似问题。

**这种连续问“为什么”的能力是一种理性思考的推理能力，不仅要求你有全面系统的技术背景知识（俗话叫“懂行”），还要你有努力求知不懈怠的态度（俗话叫“用心”）**。当你花费比别人更多花时间去思考，最终你就可以拥有几倍于别人的成功。

- 分析
    - “因为上海疫情无法盖章，所以没拿到合同额”
        
    - “因为明明知道有bug，但是产品没有跟进，最后技术上线了”
        
- 经验
    
    - “要预留好提前量，不要对客户的成单周期太乐观”
        
    - “技术上线之前，必须得到产品的确认，如果产品不确认就上线，算是违规上线。产品确认的标准是 XXXX”
        

3. 一个例子：
    

由于服务器宕机造成数据库MySQL服务挂了，进而影响上层服务，整个过程花了20分钟才修复，最终被定级成故障。

在这个例子中，你觉得故障的根因是什么？有人说服务器是根因，有人说MySQL是根因，有人说上层服务不支持功能降级，所以架构设计是根因。这么一个简单直白的问题，不同的人就会有不同的理解。如果我们把问题再复杂化一下，比如MySQL设计了主从切换，但是宕机时没切换成功，而且当时DBA还联系不上，后来联系上之后由于VPN链接不稳定又耽误了处理，那么这种情况下，你觉得故障的根因又怎么算？有人说是DBA不在岗是根因，有人说是VPN的稳定性是根因，有人说主从切换失败是根因。显然每个都像是根因，而每个又都不是根因。所以我们应该系统化地看待根因，同时把找根因的目标放在改进上去，就能走出迷局，试看下面的分析：

- VPN连接问题，和运营商网络有关，所以需要给运维人员配备两个以上运营商的上网卡。
    
- 值班机制问题，关键运维岗位需要有备份机制，必须确保至少有一人可以快速响应。
    
- MySQL主从切换不生效为什么一直没有发现，原因是缺乏定期的切换演练。
    
- 业务没做降级保护，所以要添加鲁棒性设计，并且需要对降级保护进行混沌工程试验。
    

**试想一下，上面**_**只要有其中一个环节能够做到位**_**，都会大大降低故障的影响度，哪个是根因其实已经没那么重要了。**

#### 

再次强调

故障的事后处理一定要分清楚定责和处罚的关系：**定责不等于处罚**。

- 定责的原则是对事不对人，这件事情一定要有人承担责任，这里承担责任的意思是说负责后续改进措施的执行与落地，其目的是改进。
    
- 处罚的目的是避免主观意识薄弱造成的低级且重复的错误，进而有效降低再犯的概率。同时处罚也能提升人的敬畏意识，激活其责任心，巩固其基本的职业素养和操守。
    

大家可以放心的写具体是谁出来问题，只有写的足够具体，下次如何优化才能足够落地。

不要觉得自己说别人是得罪人，更不要觉得说自己问题就会记住你不好。

团队的人都不傻，拿到桌面上分析永远是最高效的。

**再次强调，我们的目标是“如何改进”。**

#### 

复盘模板

首先，我们没有八股文，了解最核心的原理之后，你可以按照自己的理解去优化总结，你可以按照自己的想法优化文档。

然后，下面给出几个模板**仅**供参考：

- 模板：
    - 事实
    - 分析
    - 经验
    - 哪些做的好
    - 哪些做的不好
    - 后续优化方案

#### 参考链接

- [计划和复盘](https://juzihudong.feishu.cn/wiki/wikcntNRPSZjA1l3NoY1kyVVpwd#Z36TqS)
    
- [从研发效能的视角谈“故障复盘”](https://mp.weixin.qq.com/s/igpwXEEyj8sns2jrjJEZKA)